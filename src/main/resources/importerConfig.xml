<importer>
    <preParseHandlers>
        <!-- アソビストア -->
        <filter class="com.norconex.importer.handler.filter.impl.RegexReferenceFilter"
                onMatch="exclude">
            <regex>\Ahttps:\/\/shop\.asobistore\.jp\/product\/catalog\/.*\z</regex>
        </filter>
        <tagger class="com.norconex.importer.handler.tagger.impl.DOMTagger"
                parser="html"
        >
            <restrictTo
                    caseSensitive="false"
                    field="document.reference"
            >
                \Ahttps:\/\/shop\.asobistore\.jp\/products\/detail\/.*\z
            </restrictTo>
            <dom selector="header img[alt='アソビストア']"
                 extract="attr(alt)"
                 toField="product.store"
            />
            <dom selector=".box02_r h1"
                 toField="product.name"
            />
            <dom selector="#panInner a:last-child"
                 toField="product.relatedWork"
            />
            <dom selector="#panInner, #spec_size, #spec_size + .free_html"
                 toField="product.description"
            />
            <dom selector="#addcartBtn"
                 extract="tagName"
                 toField="onSale"
            />
            <dom selector=".imgicon[alt='販売終了']"
                 extract="tagName"
                 toField="endOfSale"
            />
            <dom selector=".imgicon[alt='在庫切れ']"
                 extract="tagName"
                 toField="outOfStock"
            />
            <dom selector="img#photo"
                 extract="attr(src)"
                 toField="product.image"
             />
        </tagger>
        <!-- コトブキヤオンラインショップ -->
        <filter class="com.norconex.importer.handler.filter.impl.RegexReferenceFilter"
                onMatch="exclude">
            <regex>\Ahttps:\/\/shop\.kotobukiya\.co\.jp\/shop\/e\/.*\z</regex>
        </filter>
        <tagger class="com.norconex.importer.handler.tagger.impl.DOMTagger"
                parser="html"
        >
            <restrictTo
                    caseSensitive="false"
                    field="document.reference"
            >
                \Ahttps:\/\/shop\.kotobukiya\.co\.jp\/shop\/g\/.*\z
            </restrictTo>
            <dom selector="#header img[alt='KOTOBUKIYA ONLINE SHOP']"
                 extract="attr(alt)"
                 toField="product.store"
            />
            <dom selector="#gallery .goods_name_"
                 toField="product.name"
            />
            <dom selector=".goods_about p a"
                 toField="product.relatedWork"
            />
            <dom selector=".goods_info, .goods_explain"
                 toField="product.description"
            />
            <dom selector="#cart_in"
                 extract="tagName"
                 toField="onSale"
            />
            <dom selector="#nostock"
                 extract="tagName"
                 toField="outOfStock"
            />
            <dom selector="#img_gallery img.hor"
                 extract="attr(src)"
                 toField="product.image"
            />
        </tagger>
        <!-- AMNIBUS -->
        <filter class="com.norconex.importer.handler.filter.impl.RegexReferenceFilter"
                onMatch="exclude">
            <regex>\Ahttps:\/\/amnibus\.com\/products\/list.*\z</regex>
        </filter>
        <tagger class="com.norconex.importer.handler.tagger.impl.DOMTagger"
                parser="html"
        >
            <restrictTo
                    caseSensitive="false"
                    field="document.reference"
            >
                \Ahttps:\/\/amnibus\.com\/products\/detail\/.*\z
            </restrictTo>
            <dom selector="img[alt='AMNIBUS']"
                 extract="attr(alt)"
                 toField="product.store"
            />
            <dom selector=".detail-box h1"
                 toField="product.name"
            />
            <dom selector=".detail-box cite"
                 toField="product.relatedWork"
            />
            <dom selector=".detail-note"
                 toField="product.description"
            />
            <dom selector=".detail-sale-status.is-stocked"
                 extract="tagName"
                 toField="onSale"
            />
            <dom selector=".detail-sale-status.is-finished"
                 extract="tagName"
                 toField="outOfStock"
            />
            <dom selector="#detail-slider img"
                 extract="attr(src)"
                 toField="product.image"
            />
        </tagger>
        <!-- SuperGroupies -->
        <filter class="com.norconex.importer.handler.filter.impl.RegexReferenceFilter"
                onMatch="exclude">
            <regex>\Ahttps:\/\/www\.super-groupies\.com\/search.*\z</regex>
        </filter>
        <tagger class="com.norconex.importer.handler.tagger.impl.DOMTagger"
                parser="html"
        >
            <restrictTo
                    caseSensitive="false"
                    field="document.reference"
            >
                \Ahttps:\/\/www\.super-groupies\.com\/product\/.*\z
            </restrictTo>
            <dom selector="img[alt='SuperGroupies']"
                 extract="attr(alt)"
                 toField="product.store"
            />
            <dom selector=".productName"
                 toField="product.name"
            />
            <dom selector=".productTitleLink:first-child"
                 toField="product.relatedWork"
            />
            <dom selector=".freeEdit.productDetail"
                 toField="product.description"
            />
            <dom selector=".btAddCart.btCartIn"
                 extract="tagName"
                 toField="onSale"
            />
            <dom selector=".btAddCart.btDisabled"
                 extract="tagName"
                 toField="outOfStock"
            />
            <dom selector=".productImageMain img"
                 extract="attr(src)"
                 toField="product.image"
            />
        </tagger>
        <!-- PREMIUM BANDAI -->
        <filter class="com.norconex.importer.handler.filter.impl.RegexReferenceFilter"
                onMatch="exclude">
            <regex>\Ahttps:\/\/p-bandai\.jp\/chara\/.*\z</regex>
        </filter>
        <tagger class="com.norconex.importer.handler.tagger.impl.DOMTagger"
                parser="html"
        >
            <restrictTo
                    caseSensitive="false"
                    field="document.reference"
            >
                \Ahttps:\/\/p-bandai\.jp\/item\/.*\z
            </restrictTo>
            <dom selector="#pbHeader img[alt='プレミアムバンダイ']"
                 extract="attr(alt)"
                 toField="product.store"
            />
            <dom selector="#box.productsname"
                 toField="product.name"
            />
            <dom selector="#cduWrap:first-child #cduPanNavi a:last-of-type"
                 toField="product.relatedWork"
            />
            <dom selector="table[summary='商品詳細'], .details_txt"
                 toField="product.description"
            />
            <dom selector="[name='buy'][src$='button02.gif'], [name='buy'][src$='/button02_noselect.gif']"
                 extract="tagName"
                 toField="onSale"
            />
            <dom selector="[name='buy'][src$='/disable_cart.gif']"
                 extract="tagName"
                 toField="outOfStock"
            />
            <dom selector="[alt='販売終了しました']"
                 extract="tagName"
                 toField="endOfSale"
            />
            <dom selector="[name='buy'][src$='reserve_item.gif']"
                 extract="tagName"
                 toField="acceptingReservation"
            />
            <dom selector="[alt='予約終了しました']"
                 extract="tagName"
                 toField="reservationClosed"
            />
            <dom selector="img#main_image1"
                 extract="attr(src)"
                 toField="product.image"
            />
        </tagger>
    </preParseHandlers>
    <postParseHandlers>
        <tagger class="com.norconex.importer.handler.tagger.impl.MergeTagger">
            <merge toField="product.content" deleteFromFields="false"
                   singleValue="true" singleValueSeparator="\n\n">
                <fromFields>product.name, product.relatedWork, product.description</fromFields>
            </merge>
        </tagger>
        <tagger class="com.norconex.importer.handler.tagger.impl.ReplaceTagger">
            <replace fromField="onSale" toField="product.status" regex="true" wholeMatch="true">
                <fromValue>.*</fromValue>
                <toValue>ON_SALE</toValue>
            </replace>
            <replace fromField="endOfSale" toField="product.status" regex="true" wholeMatch="true">
                <fromValue>.*</fromValue>
                <toValue>END_OF_SALE</toValue>
            </replace>
            <replace fromField="outOfStock" toField="product.status" regex="true" wholeMatch="true">
                <fromValue>.*</fromValue>
                <toValue>OUT_OF_STOCK</toValue>
            </replace>
            <replace fromField="acceptingReservation" toField="product.status" regex="true" wholeMatch="true">
                <fromValue>.*</fromValue>
                <toValue>ACCEPTING_RESERVATION</toValue>
            </replace>
            <replace fromField="reservationClosed" toField="product.status" regex="true" wholeMatch="true">
                <fromValue>.*</fromValue>
                <toValue>RESERVATION_CLOSED</toValue>
            </replace>
        </tagger>
        <tagger class="com.norconex.importer.handler.tagger.impl.KeepOnlyTagger">
            <fields>document.reference</fields>
            <fieldsRegex>product\..*</fieldsRegex>
        </tagger>
        <transformer class="com.norconex.importer.handler.transformer.impl.SubstringTransformer"
                     begin="0"
                     end="1"/>
    </postParseHandlers>
</importer>
